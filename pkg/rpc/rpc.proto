syntax = "proto3";
package proxy.rpc;
option go_package = "github.com/f110/lagrangian-proxy/pkg/server/rpc";

service Cluster {
    rpc MemberList(RequestMemberList) returns (ResponseMemberList) {}
}

service Admin {
    rpc Ping(RequestPing) returns (ResponsePong);
    rpc UserList(RequestUserList) returns (ResponseUserList);
    rpc UserAdd(RequestUserAdd) returns (ResponseUserAdd);
    rpc UserDel(RequestUserDel) returns (ResponseUserDel);
}

message RequestPing {}

message ResponsePong {}

message RequestMemberList {}

message ResponseMemberList {
    repeated ClusterMember items = 1;
}

message ClusterMember {
    string id = 1;
}

message RequestUserList {}

message ResponseUserList {
    repeated UserItem items = 1;
}

message UserItem {
    string id = 1;
    repeated string roles = 2;
}

message RequestUserAdd {
    string id = 1;
    string role = 2;
}

message ResponseUserAdd {
    bool ok = 1;
}

message RequestUserDel {
    string id = 1;
    string role = 2;
}

message ResponseUserDel {
    bool ok = 1;
}

message ErrorUnauthorized {
    string endpoint = 1;
}